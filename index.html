<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–°–≤–æ—è –∏–≥—Ä–∞</title>

<style>
body {
  margin: 0;
  background: radial-gradient(circle at top, #1a2b6f, #050a2a);
  color: #fff;
  font-family: Arial, sans-serif;
}

/* ===== TOP BAR ===== */
#topBar{
  display:flex;
  justify-content:center;
  gap:20px;
  padding:15px;
}
#topBar button{
  font-size:20px;
  padding:10px 25px;
  cursor:pointer;
  border-radius:10px;
  border:none;
  background:#2345a5;
  color:#fff;
}

.player input {
  display: block;
  margin: 0 auto 6px auto;

  width: 100%;
  max-width: 180px;

  background: transparent;
  border: none;
  border-bottom: 2px solid rgba(255,255,255,0.3);

  color: #fff;
  text-align: center;
  font-size: 20px;
  font-weight: bold;

  outline: none;
}
/* ===== BOARD ===== */
#board {
  display: grid;
  grid-template-columns: 240px repeat(5, 1fr);
  gap: 12px;
  padding: 20px;
}

.cell {
  background: linear-gradient(#2345a5, #13235c);
  border: 2px solid #0c1a4a;
  padding: 25px 10px;
  text-align: center;
  cursor: pointer;
  border-radius: 10px;
  font-size: 30px;
  font-weight: bold;
}

.cell.used { visibility:hidden; }

.theme {
  background: linear-gradient(#0e1a4f, #060d2d);
  font-size: 20px;
}

/* ===== PLAYERS ===== */
#players {
  display: flex;
  justify-content: space-around;
  padding: 15px;
}

.player {
  background: linear-gradient(#101f5c, #0b1540);
  padding: 10px 20px;
  border-radius: 14px;
  width:220px;
  text-align:center;
}

.score{ font-size:32px; margin:10px 0; }

.controls button{
  width:48px;
  height:48px;
  border-radius:50%;
  border:none;
  font-size:22px;
  cursor:pointer;
}
.ok{background:#22b455}
.bad{background:#cc3b3b}

/* ===== MODALS ===== */
.modal{
  position:fixed;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  background:radial-gradient(circle,#1b2f85,#050a2a);
  z-index:20;
}

.close{
  position:absolute;
  top:20px;
  right:30px;
  font-size:40px;
  cursor:pointer;
}

/* QUESTION */
#questionText{
  white-space: pre-line;
  font-size:clamp(24px,4vw,52px);
  text-align:center;
  max-width:80%;
  white-space:pre-line;
}

#answerText{
  white-space: pre-line;
  margin-top:20px;
  font-size:clamp(22px,4vw,50px);
  text-align:center;
  max-width:80%;
  display:none;
}

.media-images {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 25px;
  flex-wrap: wrap;
}

.media-image img {
  max-width: 800px;
  max-height: 800px;
  border-radius: 12px;
}

.media-images img {
  max-width: 500px;
  max-height: 500px;
  border-radius: 12px;
}

/* ===== CAT IN THE BAG ===== */
#catScreen{
  animation:flash 1.2s infinite alternate;
}
#catScreen h1{
  font-size:90px;
  animation:pulse 1s infinite;
}

@keyframes pulse{
  from{transform:scale(1)}
  to{transform:scale(1.15)}
}

@keyframes flash{
  from{background:#0a123a}
  to{background:#1e3cff}
}
</style>
</head>

<body>

<div id="topBar">
  <button onclick="showSponsor()">–°–ø–æ–Ω—Å–æ—Ä</button>
  <button onclick="showIntro()">–ó–∞—Å—Ç–∞–≤–∫–∞</button>
</div>

<div id="board"></div>
<div id="players"></div>

<!-- QUESTION -->
<div id="questionModal" class="modal">
  <div class="close" onclick="closeQuestion()">‚úñ</div>
  <div id="questionText"></div>
  <div id="mediaBox"></div>
  <div id="answerText"></div>
  <button onclick="showAnswer()">–û—Ç–≤–µ—Ç</button>
</div>

<!-- CAT -->
<div id="catScreen" class="modal">
  <h1>üê± –ö–û–¢ –í –ú–ï–®–ö–ï</h1>
  <button onclick="continueCat()">–î–∞–ª–µ–µ</button>
</div>

<!-- SPONSOR -->
<div id="sponsorModal" class="modal">
  <div class="close" onclick="closeSponsor()">‚úñ</div>
  <img src="media/Sponsor.png" style="max-width:90%;max-height:90%">
</div>

<!-- INTRO -->
<div id="introModal" class="modal">
  <div class="close" onclick="closeIntro()">‚úñ</div>
  <img src="media/Intro.png" style="max-width:90%;margin-bottom:20px">
</div>

<script>
let data;
let scores=[0,0,0,0];
let activeMedia=null;
let pendingQuestion=null;
let introAudio=null;

fetch('./questions.json').then(r=>r.json()).then(j=>{
  data=j;
  renderBoard();
  renderPlayers();
});

function renderBoard(){
  const b = document.getElementById('board');
  b.innerHTML = '';

  data.themes.forEach(theme => {

    // === –Ø–ß–ï–ô–ö–ê –¢–ï–ú–´ (–°–õ–ï–í–ê) ===
    const themeCell = document.createElement('div');
    themeCell.className = 'cell theme';
    themeCell.textContent = theme.title;
    b.appendChild(themeCell);

    // === –í–û–ü–†–û–°–´ –°–ü–†–ê–í–ê ===
    theme.questions.forEach(q => {
      const c = document.createElement('div');
      c.className = 'cell';
      c.textContent = q.price;

      c.onclick = () => {
        if (c.classList.contains('used')) return;
        selectQuestion(c, q);
      };

      b.appendChild(c);
    });

  });
}

let playerNames = ["–ò–≥—Ä–æ–∫ 1", "–ò–≥—Ä–æ–∫ 2", "–ò–≥—Ä–æ–∫ 3", "–ò–≥—Ä–æ–∫ 4"];
function renderPlayers(){
  const p=document.getElementById('players');
  p.innerHTML='';

  scores.forEach((s,i)=>{
    const div = document.createElement('div');
    div.className = 'player';

    div.innerHTML = `
      <input value="${playerNames[i]}" data-index="${i}">
      <div class="score">${s}</div>
      <div class="controls">
        <button class="ok">‚úî</button>
        <button class="bad">‚úñ</button>
      </div>
    `;

    // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    div.querySelector('.ok').onclick = () => {
      scores[i] += currentPrice;
      renderPlayers();
    };

    div.querySelector('.bad').onclick = () => {
      scores[i] -= currentPrice;
      renderPlayers();
    };

    const input = div.querySelector('input');
    input.oninput = (e) => {
      playerNames[i] = e.target.value;
    };

    p.appendChild(div);
  });
}


let currentPrice=0;
let catAudio = new Audio('media/cat.mp3');
function selectQuestion(cell,q){
  cell.classList.add('used');
  currentPrice=q.price;

  if(Math.random()<0.15){
    pendingQuestion=q;
    catAudio.currentTime = 0;
    catAudio.play();
    document.getElementById('catScreen').style.display='flex';
  }else{
    openQuestion(q);
  }
}

function continueCat(){
  catAudio.pause();
  catAudio.currentTime = 0;
  document.getElementById('catScreen').style.display='none';
  openQuestion(pendingQuestion);
}

function openQuestion(q){
  document.getElementById('questionText').textContent=q.question;
  document.getElementById('answerText').textContent=q.answer;
  document.getElementById('answerText').style.display='none';

  const m=document.getElementById('mediaBox');
  m.innerHTML='';
  activeMedia=null;

  if(q.media){
    if(q.media.type==='images'){
      m.innerHTML=`<div class="media-images">${q.media.src.map(s=>`<img src="${s}">`).join('')}</div>`;
    }
    if (q.media.type === 'image') {
      mediaBox.innerHTML = `
        <div class="media-image">
          <img src="${q.media.src}">
        </div>`;
    }
    if(q.media.type==='audio'){
      activeMedia=document.createElement('audio');
      activeMedia.src=q.media.src;
      activeMedia.controls=true;
      activeMedia.autoplay=true;
      m.appendChild(activeMedia);
    }
  }

  document.getElementById('questionModal').style.display='flex';
}

function showAnswer(){
  document.getElementById('answerText').style.display='block';
}

function closeQuestion(){
  if(activeMedia){activeMedia.pause();activeMedia.currentTime=0;}
  document.getElementById('questionModal').style.display='none';
}

/* SPONSOR */
function showSponsor(){
  document.getElementById('sponsorModal').style.display='flex';
}
function closeSponsor(){
  document.getElementById('sponsorModal').style.display='none';
}

/* INTRO */
function showIntro(){
  introAudio=new Audio('media/intro.mp3');
  introAudio.play();
  document.getElementById('introModal').style.display='flex';
}
function closeIntro(){
  if(introAudio){introAudio.pause();introAudio.currentTime=0;}
  document.getElementById('introModal').style.display='none';
}
</script>

</body>
</html>
